<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Dashboard - Complete Edition</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const FileText = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>;
        const BookOpen = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>;
        const Briefcase = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0H8m8 0v6a2 2 0 01-2 2H10a2 2 0 01-2-2V6" /></svg>;
        const Plus = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>;
        const Edit3 = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>;
        const Save = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3-3-3m3-3v12" /></svg>;
        const X = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>;
        const Clock = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const Moon = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>;
        const Sun = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>;
        const Calendar = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>;
        const Download = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>;
        const Upload = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>;

        const LifeDashboard = () => {
            const [activeTab, setActiveTab] = useState('diary');
            const [diaryEntries, setDiaryEntries] = useState([]);
            const [studyTasks, setStudyTasks] = useState([]);
            const [workSchedule, setWorkSchedule] = useState([]);
            const [newEntry, setNewEntry] = useState('');
            const [editingId, setEditingId] = useState(null);
            const [editText, setEditText] = useState('');
            const [saveStatus, setSaveStatus] = useState('');

            const STORAGE_KEYS = {
                diary: 'lifeDashboard_diary',
                study: 'lifeDashboard_study',
                work: 'lifeDashboard_work'
            };

            const saveToStorage = (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    setSaveStatus('保存しました ✓');
                    setTimeout(() => setSaveStatus(''), 2000);
                } catch (error) {
                    setSaveStatus('保存に失敗しました ✗');
                    setTimeout(() => setSaveStatus(''), 2000);
                }
            };

            const loadFromStorage = (key) => {
                try {
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    return [];
                }
            };

            useEffect(() => {
                setDiaryEntries(loadFromStorage(STORAGE_KEYS.diary));
                setStudyTasks(loadFromStorage(STORAGE_KEYS.study));
                setWorkSchedule(loadFromStorage(STORAGE_KEYS.work));
            }, []);

            useEffect(() => {
                if (diaryEntries.length > 0) saveToStorage(STORAGE_KEYS.diary, diaryEntries);
            }, [diaryEntries]);

            useEffect(() => {
                if (studyTasks.length > 0) saveToStorage(STORAGE_KEYS.study, studyTasks);
            }, [studyTasks]);

            useEffect(() => {
                if (workSchedule.length > 0) saveToStorage(STORAGE_KEYS.work, workSchedule);
            }, [workSchedule]);

            const downloadFile = (filename, content, type = 'text/plain') => {
                const blob = new Blob([content], { type: `${type};charset=utf-8` });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            const exportDiaryAsText = () => {
                let content = `Life Dashboard 日記\nエクスポート日時: ${new Date().toLocaleString('ja-JP')}\n${'='.repeat(50)}\n\n`;
                diaryEntries.forEach((entry, index) => {
                    content += `【${diaryEntries.length - index}】 ${entry.timestamp}\n${'-'.repeat(40)}\n${entry.content}\n\n`;
                });
                const today = new Date().toISOString().split('T')[0];
                downloadFile(`日記_${today}.txt`, content);
                setSaveStatus('日記をテキストファイルでエクスポートしました ✓');
                setTimeout(() => setSaveStatus(''), 3000);
            };

            const exportStudyAsText = () => {
                let content = `Life Dashboard 勉強記録\nエクスポート日時: ${new Date().toLocaleString('ja-JP')}\n${'='.repeat(50)}\n\n`;
                const completed = studyTasks.filter(t => t.completed);
                const pending = studyTasks.filter(t => !t.completed);
                
                content += `【完了済み】 (${completed.length}件)\n${'-'.repeat(30)}\n`;
                completed.forEach(task => content += `✓ ${task.subject} (${task.date})\n`);
                
                content += `\n【未完了】 (${pending.length}件)\n${'-'.repeat(30)}\n`;
                pending.forEach(task => content += `□ ${task.subject} (${task.date})\n`);
                
                const today = new Date().toISOString().split('T')[0];
                downloadFile(`勉強記録_${today}.txt`, content);
                setSaveStatus('勉強記録をテキストファイルでエクスポートしました ✓');
                setTimeout(() => setSaveStatus(''), 3000);
            };

            const exportWorkAsText = () => {
                let content = `Life Dashboard 仕事記録\nエクスポート日時: ${new Date().toLocaleString('ja-JP')}\n${'='.repeat(50)}\n\n`;
                content += `【シフトパターン説明】\nパターン: a1a2a3a4 z1 b1b2b3b4 z2 c1c2c3c4 z3z4\na: 日勤, b: 夜勤, c: 深夜勤, z: 休み (z3は深夜勤明けの休み)\n\n`;
                content += `【勤務記録】\n${'-'.repeat(30)}\n`;
                workSchedule.forEach(schedule => {
                    const shiftNames = { a: '日勤', b: '夜勤', c: '深夜勤', z: '休み' };
                    const shiftName = shiftNames[schedule.shift.toLowerCase().charAt(0)] || '不明';
                    content += `${schedule.date}: ${schedule.shift} (${shiftName})\n`;
                });
                
                const today = new Date().toISOString().split('T')[0];
                downloadFile(`仕事記録_${today}.txt`, content);
                setSaveStatus('仕事記録をテキストファイルでエクスポートしました ✓');
                setTimeout(() => setSaveStatus(''), 3000);
            };

            const exportAllAsCSV = () => {
                let csv = '種別,日時,内容,完了状態\n';
                diaryEntries.forEach(entry => {
                    const content = entry.content.replace(/"/g, '""').replace(/\n/g, ' ');
                    csv += `日記,"${entry.timestamp}","${content}",\n`;
                });
                studyTasks.forEach(task => {
                    const subject = task.subject.replace(/"/g, '""');
                    csv += `勉強,"${task.date}","${subject}","${task.completed ? '完了' : '未完了'}"\n`;
                });
                workSchedule.forEach(schedule => {
                    csv += `仕事,"${schedule.date}","${schedule.shift}",\n`;
                });
                
                const today = new Date().toISOString().split('T')[0];
                downloadFile(`LifeDashboard_全データ_${today}.csv`, '\uFEFF' + csv, 'text/csv');
                setSaveStatus('全データをCSVファイルでエクスポートしました ✓');
                setTimeout(() => setSaveStatus(''), 3000);
            };

            const exportAllAsJSON = () => {
                const data = {
                    exportDate: new Date().toISOString(),
                    diary: diaryEntries,
                    study: studyTasks,
                    work: workSchedule
                };
                const today = new Date().toISOString().split('T')[0];
                downloadFile(`LifeDashboard_バックアップ_${today}.json`, JSON.stringify(data, null, 2), 'application/json');
                setSaveStatus('全データをJSONファイルでバックアップしました ✓');
                setTimeout(() => setSaveStatus(''), 3000);
            };

            const importFromJSON = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.diary) setDiaryEntries(data.diary);
                        if (data.study) setStudyTasks(data.study);
                        if (data.work) setWorkSchedule(data.work);
                        setSaveStatus('JSONファイルからデータをインポートしました ✓');
                        setTimeout(() => setSaveStatus(''), 3000);
                    } catch (error) {
                        setSaveStatus('ファイルの読み込みに失敗しました ✗');
                        setTimeout(() => setSaveStatus(''), 3000);
                    }
                };
                reader.readAsText(file);
                event.target.value = '';
            };

            const shiftPatterns = {
                a: { name: '日勤', icon: Sun, color: 'bg-yellow-100 text-yellow-800' },
                b: { name: '夜勤', icon: Moon, color: 'bg-blue-100 text-blue-800' },
                c: { name: '深夜勤', icon: Clock, color: 'bg-purple-100 text-purple-800' },
                z: { name: '休み', icon: Calendar, color: 'bg-green-100 text-green-800' }
            };

            const today = new Date().toISOString().split('T')[0];

            const addDiaryEntry = () => {
                if (newEntry.trim()) {
                    const entry = {
                        id: Date.now(),
                        date: today,
                        content: newEntry,
                        timestamp: new Date().toLocaleString('ja-JP')
                    };
                    setDiaryEntries([entry, ...diaryEntries]);
                    setNewEntry('');
                }
            };

            const addStudyTask = () => {
                if (newEntry.trim()) {
                    const task = {
                        id: Date.now(),
                        subject: newEntry,
                        completed: false,
                        date: today
                    };
                    setStudyTasks([...studyTasks, task]);
                    setNewEntry('');
                }
            };

            const addWorkSchedule = () => {
                if (newEntry.trim()) {
                    const schedule = {
                        id: Date.now(),
                        date: today,
                        shift: newEntry,
                        notes: ''
                    };
                    setWorkSchedule([...workSchedule, schedule]);
                    setNewEntry('');
                }
            };

            const toggleStudyTask = (id) => {
                setStudyTasks(studyTasks.map(task =>
                    task.id === id ? { ...task, completed: !task.completed } : task
                ));
            };

            const startEdit = (id, text) => {
                setEditingId(id);
                setEditText(text);
            };

            const saveEdit = (id, type) => {
                if (type === 'diary') {
                    setDiaryEntries(diaryEntries.map(entry =>
                        entry.id === id ? { ...entry, content: editText } : entry
                    ));
                } else if (type === 'study') {
                    setStudyTasks(studyTasks.map(task =>
                        task.id === id ? { ...task, subject: editText } : task
                    ));
                }
                setEditingId(null);
                setEditText('');
            };

            const deleteEntry = (id, type) => {
                if (type === 'diary') {
                    setDiaryEntries(diaryEntries.filter(entry => entry.id !== id));
                } else if (type === 'study') {
                    setStudyTasks(studyTasks.filter(task => task.id !== id));
                } else if (type === 'work') {
                    setWorkSchedule(workSchedule.filter(schedule => schedule.id !== id));
                }
            };

            const clearAllData = () => {
                if (confirm('すべてのデータを削除しますか？この操作は取り消せません。')) {
                    Object.values(STORAGE_KEYS).forEach(key => localStorage.removeItem(key));
                    setDiaryEntries([]);
                    setStudyTasks([]);
                    setWorkSchedule([]);
                    setSaveStatus('すべてのデータを削除しました');
                    setTimeout(() => setSaveStatus(''), 2000);
                }
            };

            const tabs = [
                { id: 'diary', name: '日記', icon: FileText },
                { id: 'study', name: '勉強', icon: BookOpen },
                { id: 'work', name: '仕事', icon: Briefcase }
            ];

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-4xl mx-auto">
                        <header className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">Life Dashboard</h1>
                            <p className="text-gray-600">勉強・仕事・日記を一つの場所で管理</p>
                            <p className="text-sm text-gray-500 mt-2">{new Date().toLocaleDateString('ja-JP', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric',
                                weekday: 'long'
                            })}</p>
                            
                            {saveStatus && (
                                <div className="text-sm text-blue-600 font-medium mt-2">
                                    {saveStatus}
                                </div>
                            )}
                        </header>

                        {/* エクスポート・インポートパネル */}
                        <div className="bg-white rounded-lg shadow-md p-4 mb-6">
                            <h3 className="text-lg font-semibold mb-4 text-gray-800">📁 データ管理 (文字化けなし)</h3>
                            
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2 mb-4">
                                <button onClick={exportDiaryAsText} className="flex items-center justify-center px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm">
                                    <Download /><span className="ml-1">日記.txt</span>
                                </button>
                                <button onClick={exportStudyAsText} className="flex items-center justify-center px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm">
                                    <Download /><span className="ml-1">勉強.txt</span>
                                </button>
                                <button onClick={exportWorkAsText} className="flex items-center justify-center px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm">
                                    <Download /><span className="ml-1">仕事.txt</span>
                                </button>
                                <button onClick={exportAllAsCSV} className="flex items-center justify-center px-3 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-sm">
                                    <Download /><span className="ml-1">全データ.csv</span>
                                </button>
                            </div>

                            <div className="flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-4">
                                <button onClick={exportAllAsJSON} className="flex items-center justify-center px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors">
                                    <Download /><span className="ml-2">完全バックアップ (JSON)</span>
                                </button>
                                
                                <label className="flex items-center justify-center px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors cursor-pointer">
                                    <Upload /><span className="ml-2">データ復元</span>
                                    <input type="file" accept=".json" onChange={importFromJSON} className="hidden" />
                                </label>
                                
                                <button onClick={clearAllData} className="flex items-center justify-center px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                    <X /><span className="ml-2">全データ削除</span>
                                </button>
                            </div>
                            
                            <p className="text-xs text-gray-500 mt-3 text-center">
                                📝 テキスト・CSVファイルは文字化けしません | 💾 JSONファイルは完全復元可能
                            </p>
                        </div>

                        {/* タブナビゲーション */}
                        <div className="flex justify-center mb-6">
                            <div className="bg-white rounded-lg p-1 shadow-md">
                                {tabs.map(tab => {
                                    const Icon = tab.icon;
                                    return (
                                        <button
                                            key={tab.id}
                                            onClick={() => setActiveTab(tab.id)}
                                            className={`flex items-center px-4 py-2 rounded-md transition-all ${
                                                activeTab === tab.id
                                                    ? 'bg-blue-500 text-white shadow-md'
                                                    : 'text-gray-600 hover:bg-gray-100'
                                            }`}
                                        >
                                            <Icon />
                                            <span className="ml-2">{tab.name}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* コンテンツエリア */}
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            {/* 日記タブ */}
                            {activeTab === 'diary' && (
                                <div>
                                    <h2 className="text-2xl font-bold mb-4 flex items-center">
                                        <FileText />
                                        <span className="ml-2 text-blue-500">日記</span>
                                        <span className="ml-4 text-sm text-gray-500">({diaryEntries.length}件)</span>
                                    </h2>
                                    
                                    <div className="mb-6">
                                        <textarea
                                            value={newEntry}
                                            onChange={(e) => setNewEntry(e.target.value)}
                                            placeholder="今日の出来事や感想を書いてください..."
                                            className="w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            rows="3"
                                        />
                                        <button
                                            onClick={addDiaryEntry}
                                            className="mt-2 flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                                        >
                                            <Plus />
                                            <span className="ml-1">追加</span>
                                        </button>
                                    </div>

                                    <div className="space-y-4">
                                        {diaryEntries.map(entry => (
                                            <div key={entry.id} className="bg-gray-50 rounded-lg p-4 border-l-4 border-blue-400">
                                                <div className="flex justify-between items-start mb-2">
                                                    <span className="text-sm text-gray-500">{entry.timestamp}</span>
                                                    <div className="flex space-x-2">
                                                        <button
                                                            onClick={() => startEdit(entry.id, entry.content)}
                                                            className="text-gray-400 hover:text-blue-500"
                                                        >
                                                            <Edit3 />
                                                        </button>
                                                        <button
                                                            onClick={() => deleteEntry(entry.id, 'diary')}
                                                            className="text-gray-400 hover:text-red-500"
                                                        >
                                                            <X />
                                                        </button>
                                                    </div>
                                                </div>
                                                {editingId === entry.id ? (
                                                    <div>
                                                        <textarea
                                                            value={editText}
                                                            onChange={(e) => setEditText(e.target.value)}
                                                            className="w-full p-2 border border-gray-300 rounded-md"
                                                            rows="3"
                                                        />
                                                        <button
                                                            onClick={() => saveEdit(entry.id, 'diary')}
                                                            className="mt-2 px-3 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center"
                                                        >
                                                            <Save />
                                                        </button>
                                                    </div>
                                                ) : (
                                                    <p className="text-gray-700 whitespace-pre-wrap">{entry.content}</p>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* 勉強タブ */}
                            {activeTab === 'study' && (
                                <div>
                                    <h2 className="text-2xl font-bold mb-4 flex items-center">
                                        <BookOpen />
                                        <span className="ml-2 text-green-500">勉強</span>
                                        <span className="ml-4 text-sm text-gray-500">
                                            ({studyTasks.filter(t => t.completed).length}/{studyTasks.length}完了)
                                        </span>
                                    </h2>
                                    
                                    <div className="mb-6">
                                        <input
                                            type="text"
                                            value={newEntry}
                                            onChange={(e) => setNewEntry(e.target.value)}
                                            placeholder="勉強する科目やタスクを入力..."
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                        />
                                        <button
                                            onClick={addStudyTask}
                                            className="mt-2 flex items-center px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                                        >
                                            <Plus />
                                            <span className="ml-1">追加</span>
                                        </button>
                                    </div>

                                    <div className="space-y-3">
                                        {studyTasks.map(task => (
                                            <div key={task.id} className={`flex items-center justify-between p-3 rounded-lg border ${
                                                task.completed ? 'bg-green-50 border-green-200' : 'bg-gray-50 border-gray-200'
                                            }`}>
                                                <div className="flex items-center">
                                                    <input
                                                        type="checkbox"
                                                        checked={task.completed}
                                                        onChange={() => toggleStudyTask(task.id)}
                                                        className="mr-3 w-4 h-4 text-green-600 rounded focus:ring-green-500"
                                                    />
                                                    {editingId === task.id ? (
                                                        <input
                                                            type="text"
                                                            value={editText}
                                                            onChange={(e) => setEditText(e.target.value)}
                                                            className="flex-1 p-1 border border-gray-300 rounded"
                                                        />
                                                    ) : (
                                                        <span className={`${task.completed ? 'line-through text-gray-500' : 'text-gray-700'}`}>
                                                            {task.subject}
                                                        </span>
                                                    )}
                                                </div>
                                                <div className="flex space-x-2">
                                                    {editingId === task.id ? (
                                                        <button
                                                            onClick={() => saveEdit(task.id, 'study')}
                                                            className="text-green-500 hover:text-green-700"
                                                        >
                                                            <Save />
                                                        </button>
                                                    ) : (
                                                        <button
                                                            onClick={() => startEdit(task.id, task.subject)}
                                                            className="text-gray-400 hover:text-blue-500"
                                                        >
                                                            <Edit3 />
                                                        </button>
                                                    )}
                                                    <button
                                                        onClick={() => deleteEntry(task.id, 'study')}
                                                        className="text-gray-400 hover:text-red-500"
                                                    >
                                                        <X />
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* 仕事タブ */}
                            {activeTab === 'work' && (
                                <div>
                                    <h2 className="text-2xl font-bold mb-4 flex items-center">
                                        <Briefcase />
                                        <span className="ml-2 text-purple-500">仕事・シフト管理</span>
                                        <span className="ml-4 text-sm text-gray-500">({workSchedule.length}件)</span>
                                    </h2>

                                    {/* シフトパターン説明 */}
                                    <div className="mb-6 p-4 bg-gray-50 rounded-lg">
                                        <h3 className="font-semibold mb-3">シフトパターン: a1a2a3a4 z1 b1b2b3b4 z2 c1c2c3c4 z3z4</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                            {Object.entries(shiftPatterns).map(([key, pattern]) => {
                                                const Icon = pattern.icon;
                                                return (
                                                    <div key={key} className={`flex items-center p-2 rounded-md ${pattern.color}`}>
                                                        <Icon />
                                                        <span className="font-medium ml-2">{key.toUpperCase()}:</span>
                                                        <span className="ml-1">{pattern.name}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                        <p className="text-sm text-gray-600 mt-2">※z3は深夜勤明けの休み</p>
                                    </div>
                                    
                                    <div className="mb-6">
                                        <input
                                            type="text"
                                            value={newEntry}
                                            onChange={(e) => setNewEntry(e.target.value)}
                                            placeholder="シフト情報を入力 (例: a1, b2, c3, z1)"
                                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        />
                                        <button
                                            onClick={addWorkSchedule}
                                            className="mt-2 flex items-center px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors"
                                        >
                                            <Plus />
                                            <span className="ml-1">追加</span>
                                        </button>
                                    </div>

                                    <div className="space-y-3">
                                        {workSchedule.map(schedule => {
                                            const shiftType = schedule.shift.toLowerCase().charAt(0);
                                            const pattern = shiftPatterns[shiftType] || { name: '不明', color: 'bg-gray-100 text-gray-800', icon: Clock };
                                            const Icon = pattern.icon;
                                            
                                            return (
                                                <div key={schedule.id} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg border">
                                                    <div className="flex items-center">
                                                        <div className={`flex items-center px-3 py-1 rounded-md mr-3 ${pattern.color}`}>
                                                            <Icon />
                                                            <span className="font-medium ml-1">{schedule.shift}</span>
                                                        </div>
                                                        <span className="text-gray-600">{schedule.date}</span>
                                                        <span className="ml-2 text-sm text-gray-500">({pattern.name})</span>
                                                    </div>
                                                    <button
                                                        onClick={() => deleteEntry(schedule.id, 'work')}
                                                        className="text-gray-400 hover:text-red-500"
                                                    >
                                                        <X />
                                                    </button>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<LifeDashboard />, document.getElementById('root'));
    </script>
</body>
</html>